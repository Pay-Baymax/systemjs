{"version":3,"file":"amd.min.js","sources":["../../src/extras/amd.js"],"sourcesContent":["/*\n * Support for AMD loading\n */\n(function (global) {\n  const systemPrototype = global.System.constructor.prototype;\n\n  const emptyInstantiation = [[], function () { return {} }];\n\n  function unsupportedRequire () {\n    throw Error('AMD require not supported.');\n  }\n\n  let tmpRegister, firstNamedDefine;\n\n  function emptyFn () {}\n\n  const requireExportsModule = ['require', 'exports', 'module'];\n\n  function createAMDRegister (amdDefineDeps, amdDefineExec) {\n    const exports = {};\n    const module = { exports: exports };\n    const depModules = [];\n    const setters = [];\n    let splice = 0;\n    for (let i = 0; i < amdDefineDeps.length; i++) {\n      const id = amdDefineDeps[i];\n      const index = setters.length;\n      if (id === 'require') {\n        depModules[i] = unsupportedRequire;\n        splice++;\n      }\n      else if (id === 'module') {\n        depModules[i] = module;\n        splice++;\n      }\n      else if (id === 'exports') {\n        depModules[i] = exports;\n        splice++;\n      }\n      else {\n        // needed for ie11 lack of iteration scope\n        const idx = i;\n        setters.push(function (ns) {\n          depModules[idx] = ns.__useDefault ? ns.default : ns;\n        });\n      }\n      if (splice)\n        amdDefineDeps[index] = id;\n    }\n    if (splice)\n      amdDefineDeps.length -= splice;\n    const amdExec = amdDefineExec;\n    return [amdDefineDeps, function (_export) {\n      _export({ default: exports, __useDefault: true });\n      return {\n        setters: setters,\n        execute: function () {\n          const amdResult = amdExec.apply(exports, depModules);\n          if (amdResult !== undefined)\n            module.exports = amdResult;\n          if (exports !== module.exports)\n            _export('default', module.exports);\n        }\n      };\n    }];\n  }\n\n  // hook System.register to know the last declaration binding\n  let lastRegisterDeclare;\n  const systemRegister = systemPrototype.register;\n  systemPrototype.register = function (name, deps, declare) {\n    lastRegisterDeclare = typeof name === 'string' ? declare : deps;\n    systemRegister.apply(this, arguments);\n  };\n\n  const instantiate = systemPrototype.instantiate;\n  systemPrototype.instantiate = function() {\n    // Reset \"currently executing script\"\n    amdDefineDeps = null;\n    return instantiate.apply(this, arguments);\n  };\n\n  const getRegister = systemPrototype.getRegister;\n  systemPrototype.getRegister = function () {\n    if (tmpRegister)\n      return tmpRegister;\n\n    const _firstNamedDefine = firstNamedDefine;\n    firstNamedDefine = null;\n\n    const register = getRegister.call(this);\n    // if its an actual System.register leave it\n    if (register && register[1] === lastRegisterDeclare)\n      return register;\n\n    const _amdDefineDeps = amdDefineDeps;\n    amdDefineDeps = null;\n\n    // If the script registered a named module, return that module instead of re-instantiating it.\n    if (_firstNamedDefine)\n      return _firstNamedDefine;\n\n    // otherwise AMD takes priority\n    // no registration -> attempt AMD detection\n    if (!_amdDefineDeps)\n      return register || emptyInstantiation;\n\n    return createAMDRegister(_amdDefineDeps, amdDefineExec);\n  };\n  let amdDefineDeps, amdDefineExec;\n  global.define = function (name, deps, execute) {\n    // define('', [], function () {})\n    if (typeof name === 'string') {\n      const depsAndExec = getDepsAndExec(deps, execute);\n      if (amdDefineDeps) {\n        if (!System.registerRegistry)\n          throw Error('Include the named register extension for SystemJS named AMD support.');\n        addToRegisterRegistry(name, createAMDRegister(depsAndExec[0], depsAndExec[1]));\n        amdDefineDeps = [];\n        amdDefineExec = emptyFn;\n        return;\n      }\n      else {\n        if (System.registerRegistry)\n          addToRegisterRegistry(name, createAMDRegister([].concat(depsAndExec[0]), depsAndExec[1]));\n        name = deps;\n        deps = execute;\n      }\n    }\n    const depsAndExec = getDepsAndExec(name, deps);\n    amdDefineDeps = depsAndExec[0];\n    amdDefineExec = depsAndExec[1];\n  };\n  global.define.amd = {};\n\n  function getDepsAndExec(arg1, arg2) {\n    // define([], function () {})\n    if (arg1 instanceof Array) {\n      return [arg1, arg2];\n    }\n    // define({})\n    else if (typeof arg1 === 'object') {\n      return [[], function () { return arg1 }];\n    }\n    // define(function () {})\n    else if (typeof arg1 === 'function') {\n      return [requireExportsModule, arg1];\n    }\n  }\n\n  function addToRegisterRegistry(name, define) {\n    if (!firstNamedDefine) {\n      firstNamedDefine = define;\n      Promise.resolve().then(function () {\n        firstNamedDefine = null;\n      });\n    }\n\n    // We must call System.getRegister() here to give other extras, such as the named-exports extra,\n    // a chance to modify the define before it's put into the registerRegistry.\n    // See https://github.com/systemjs/systemjs/issues/2073\n    tmpRegister = define;\n    System.registerRegistry[name] = System.getRegister();\n    tmpRegister = null;\n  }\n})(typeof self !== 'undefined' ? self : global);\n"],"names":[],"mappings":"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"}