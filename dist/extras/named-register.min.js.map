{"version":3,"file":"named-register.min.js","sources":["../../src/extras/named-register.js"],"sourcesContent":["/*\n * SystemJS named register extension\n * Supports System.register('name', [..deps..], function (_export, _context) { ... })\n * \n * Names are written to the registry as-is\n * System.register('x', ...) can be imported as System.import('x')\n */\n(function (global) {\n  const System = global.System;\n  setRegisterRegistry(System);\n  const systemJSPrototype = System.constructor.prototype;\n  const constructor = System.constructor;\n  const SystemJS = function () {\n    constructor.call(this);\n    setRegisterRegistry(this);\n  };\n  SystemJS.prototype = systemJSPrototype;\n  System.constructor = SystemJS;\n\n  let firstNamedDefine;\n\n  function setRegisterRegistry(systemInstance) {\n    systemInstance.registerRegistry = Object.create(null);\n  }\n\n  const register = systemJSPrototype.register;\n  systemJSPrototype.register = function (name, deps, declare) {\n    if (typeof name !== 'string')\n      return register.apply(this, arguments);\n    const define = [deps, declare];\n    this.registerRegistry[name] = define;\n    if (!firstNamedDefine) {\n      firstNamedDefine = define;\n      Promise.resolve().then(function () {\n        firstNamedDefine = null;\n      });\n    }\n    return register.apply(this, arguments);\n  };\n\n  const resolve = systemJSPrototype.resolve;\n  systemJSPrototype.resolve = function (id, parentURL) {\n    try {\n      // Prefer import map (or other existing) resolution over the registerRegistry\n      return resolve.call(this, id, parentURL);\n    } catch (err) {\n      if (id in this.registerRegistry) {\n        return id;\n      }\n      throw err;\n    }\n  };\n\n  const instantiate = systemJSPrototype.instantiate;\n  systemJSPrototype.instantiate = function (url, firstParentUrl) {\n    const result = this.registerRegistry[url];\n    if (result) {\n      this.registerRegistry[url] = null;\n      return result;\n    } else {\n      return instantiate.call(this, url, firstParentUrl);\n    }\n  };\n\n  const getRegister = systemJSPrototype.getRegister;\n  systemJSPrototype.getRegister = function () {\n    // Calling getRegister() because other extras need to know it was called so they can perform side effects\n    const register = getRegister.call(this);\n\n    const result = firstNamedDefine || register;\n    firstNamedDefine = null;\n    return result;\n  }\n})(typeof self !== 'undefined' ? self : global);\n"],"names":[],"mappings":"yBAAA;;;;;;;AAOA,CAAC,UAAU,MAAM,EAAE;EACjB,MAAM,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;EAC7B,mBAAmB,CAAC,MAAM,CAAC,CAAC;EAC5B,MAAM,iBAAiB,GAAG,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC;EACvD,MAAM,WAAW,GAAG,MAAM,CAAC,WAAW,CAAC;EACvC,MAAM,QAAQ,GAAG,YAAY;IAC3B,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACvB,mBAAmB,CAAC,IAAI,CAAC,CAAC;GAC3B,CAAC;EACF,QAAQ,CAAC,SAAS,GAAG,iBAAiB,CAAC;EACvC,MAAM,CAAC,WAAW,GAAG,QAAQ,CAAC;;EAE9B,IAAI,gBAAgB,CAAC;;EAErB,SAAS,mBAAmB,CAAC,cAAc,EAAE;IAC3C,cAAc,CAAC,gBAAgB,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;GACvD;;EAED,MAAM,QAAQ,GAAG,iBAAiB,CAAC,QAAQ,CAAC;EAC5C,iBAAiB,CAAC,QAAQ,GAAG,UAAU,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE;IAC1D,IAAI,OAAO,IAAI,KAAK,QAAQ;MAC1B,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;IACzC,MAAM,MAAM,GAAG,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;IAC/B,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;IACrC,IAAI,CAAC,gBAAgB,EAAE;MACrB,gBAAgB,GAAG,MAAM,CAAC;MAC1B,OAAO,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,YAAY;QACjC,gBAAgB,GAAG,IAAI,CAAC;OACzB,CAAC,CAAC;KACJ;IACD,OAAO,QAAQ,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;GACxC,CAAC;;EAEF,MAAM,OAAO,GAAG,iBAAiB,CAAC,OAAO,CAAC;EAC1C,iBAAiB,CAAC,OAAO,GAAG,UAAU,EAAE,EAAE,SAAS,EAAE;IACnD,IAAI;;MAEF,OAAO,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,EAAE,SAAS,CAAC,CAAC;KAC1C,CAAC,OAAO,GAAG,EAAE;MACZ,IAAI,EAAE,IAAI,IAAI,CAAC,gBAAgB,EAAE;QAC/B,OAAO,EAAE,CAAC;OACX;MACD,MAAM,GAAG,CAAC;KACX;GACF,CAAC;;EAEF,MAAM,WAAW,GAAG,iBAAiB,CAAC,WAAW,CAAC;EAClD,iBAAiB,CAAC,WAAW,GAAG,UAAU,GAAG,EAAE,cAAc,EAAE;IAC7D,MAAM,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC;IAC1C,IAAI,MAAM,EAAE;MACV,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;MAClC,OAAO,MAAM,CAAC;KACf,MAAM;MACL,OAAO,WAAW,CAAC,IAAI,CAAC,IAAI,EAAE,GAAG,EAAE,cAAc,CAAC,CAAC;KACpD;GACF,CAAC;;EAEF,MAAM,WAAW,GAAG,iBAAiB,CAAC,WAAW,CAAC;EAClD,iBAAiB,CAAC,WAAW,GAAG,YAAY;;IAE1C,MAAM,QAAQ,GAAG,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;IAExC,MAAM,MAAM,GAAG,gBAAgB,IAAI,QAAQ,CAAC;IAC5C,gBAAgB,GAAG,IAAI,CAAC;IACxB,OAAO,MAAM,CAAC;IACf;CACF,EAAE,OAAO,IAAI,KAAK,WAAW,GAAG,IAAI,GAAG,MAAM,CAAC,CAAC"}